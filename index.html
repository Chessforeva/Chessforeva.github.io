<!DOCTYPE html>
<html>
<head>


  <!--
    If you are serving your web app in a path other than the root, change the
    href value below to reflect the base path you are serving from.

    The path provided below has to start and end with a slash "/" in order for
    it to work correctly.

    For more details:
    * https://developer.mozilla.org/en-US/docs/Web/HTML/Element/base

    This is a placeholder for base href that will be replaced by the value of
    the `--base-href` argument provided to `flutter build`.
  -->
  
  <div id="bg" style="width:0px;height:0px;position:absolute;top:0px;left:0px;" onmousedown="preventaction(event)"></div>
  <div id="debug" style="width:200px;height:400px;position:absolute;top:0px;left:0px;"></div>


  <base href="/">

  <meta charset="UTF-8">
  <meta content="IE=Edge" http-equiv="X-UA-Compatible">
  <meta name="description" content="Play browser chess made in flutter.">

  <!-- iOS meta tags & icons -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="apple-mobile-web-app-title" content="fluti_chess">
  <link rel="apple-touch-icon" href="icons/fluti_chess_192.png">

  <!-- Favicon -->
  <link rel="icon" type="image/png" href="fluti_chess.png"/>

  <title>FlutiChess</title>
  <link rel="manifest" href="manifest.json">

  <script>
    // The value below is injected by flutter build, do not touch.
    const serviceWorkerVersion = "3966983215";
  </script>
  <!-- This script adds the flutter initialization JS code -->
  <script src="flutter.js" defer></script>
</head>

<body onload="callMyOnload()">



<style>
canvas { -webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
outline: 0;
}
</style>



  <script>
    window.addEventListener('load', function(ev) {
      // Download main.dart.js
      _flutter.loader.loadEntrypoint({
        serviceWorker: {
          serviceWorkerVersion: serviceWorkerVersion,
        },
        onEntrypointLoaded: function(engineInitializer) {
          engineInitializer.initializeEngine().then(function(appRunner) {
            appRunner.runApp();
          });
        }
      });
    });

// Small modifications to make this game more playable


// just mouse action cancelled...
function preventaction( event )
{
if(event.preventDefault)
 {
 event.preventDefault();
 }
else event.returnvalue = false;
if(typeof(event.stopPropagation)!="undefined") {
	event.stopPropagation();
	}
return false;
}


// capture and redirect url of canvas canvaskit scripts 
function callMyBaseUrlTrap(s) {
	return s;
}


document.addEventListener('contextmenu', preventaction);

_captured_pointerdown = {};
_captured_pointerup = {};
_captured_click = {};
_captured_scroll = {};
_captured_wheel = {};
_captured_keydown = {};
_captured_keypress = {};
_captured_keyup = {};
_captured_popstate = {};
_captured_blur = {};
_captured_focus = {};

function captured_prevent( event, fu )
{
if(event.preventDefault)
	{
	event.preventDefault();
	}
 else event.returnvalue = false;
 if(typeof(event.stopPropagation)!="undefined") {
	event.stopPropagation();
	}
 fu(event);
 return false;
}
 
// Currently unsolved capture
 
function capturedPointerDown( event ) { return captured_prevent( event, _captured_pointerdown ); }
function capturedPointerUp( event ) { return captured_prevent( event, _captured_pointerup ); }
function capturedClick( event ) { return captured_prevent( event, _captured_click ); }
function capturedScroll( event ) { return captured_prevent( event, _captured_scroll ); }
function capturedWheel( event ) { return captured_prevent( event, _captured_wheel ); }
function capturedKeyDown( event ) { return captured_prevent( event, _captured_keydown ); }
function capturedKeyPress( event ) { return captured_prevent( event, _captured_keypress ); }
function capturedKeyUp( event ) { return captured_prevent( event, _captured_keyup ); }
function capturedPopstate( event ) { return captured_prevent( event, _captured_popstate ); }
function capturedBlur( event ) { return captured_prevent( event, _captured_blur ); }
function capturedFocus( event ) { return captured_prevent( event, _captured_focus ); }

_all_events = [];

function callMyAddEventListener(b,c) {

	_all_events.push(b);
	//"load","error","keydown","keyup","click",
	//"pointerdown","pointermove","pointerleave","pointerup","pointercancel",
	//"wheel","popstate","webglcontextlost","webglcontextrestored"
	
	if(b=="pointerdown") {
		_captured_pointerdown = c;
		return capturedPointerDown;
	}

	if(b=="pointerup") {
		_captured_pointerup = c;
		return capturedPointerUp;
	}
	if(b=="click") {
		_captured_click = c;
		return capturedClick;
	}
	if(b=="scroll") {
		_captured_scroll = c;
		return capturedScroll;
	}
	if(b=="wheel") {
		_captured_wheel = c;
		return capturedWheel;
	}
	if(b=="keydown") {
		_captured_keydown = c;
		return capturedKeyDown;
	}
	if(b=="keypress") {
		_captured_keypress = c;
		return capturedKeyPress
	}
	if(b=="keyup") {
		_captured_keyup = c;
		return capturedKeyUp;
	}
	if(b=="popstate") {
		_captured_popstate = c;
		return capturedPopstate;
	}
	if(b=="blur") {
		_captured_blur = c;
		return capturedBlur;
	}
	if(b=="focus") {
		_captured_focus = c;
		return capturedFocus;
	}
	return c;
}

// capture on body loaded
function callMyOnload() {
	setTimeout('SetMyTitle()',3000);
}

_CANVAS = {}

function callMyGetCanvas(a) {
	_CANVAS = a;
}

function callMyEventCase(b) {
	if(b.length) {
		var w = b[0];
		if( typeof(w.type)=="string"  && w.type!="pointermove") {
		 if( w.type.indexOf("pointerdown")>=0 ) {
			var event = w;
			if(event.preventDefault)
				{
				event.preventDefault();
				}
			event.returnvalue = false;

			if(typeof(event.stopPropagation)!="undefined") {
				event.stopPropagation();
			}
			_CANVAS.focus();
		 }
		 var debug = document.getElementById('debug');
		 if(typeof(_CANVAS.width)!="undefined") {
			debug.style.left = '1200px';
			debug.style.top = '20px';
			debug.style.zIndex = 8888;
			}
		 debug.innerHTML+='['+ w.type + ']';
		 setTimeout('clearDebug()',3000);
		}
	}
}

function clearDebug() {
 var debug = document.getElementById('debug');
 debug.innerHTML='';
}

function SetMyTitle() {
	document.title = "FlutiChess dbg1";
	var g = document.getElementById('debug');
	if(g!=null) {
		g.style.zIndex = 8888;
	}
	//var g = document.getElementById('bg');
	//if(g!=null) {
	//	g.style.zIndex = 8888;
	//	g.addEventListener('pointerdown',_captured_pointerdown);
	//	g.addEventListener('click',_captured_pointerdown);
	//	}
}

  </script>
</body>
</html>
